class ToggleSidebar{addedSidebar=!1;initialized=!1;body=!1;sidebars=!1;sidebarElements=!1;sidebarList=!1;constructor(e){this.openActionHandler=this.openSidebar.bind(this),this.closeActionHandler=this.closeSidebar.bind(this),this.bodyActionHandler=this.sidebarBodyListener.bind(this),void 0!==e?this.addSidebar(e):this.init()}addSidebar(e){const t="Configuration error when adding a toggle sidebar:";let i=[];this.addSidebar_SBOE(e),e.name=this.addSidebar_autoNaming(e.name);const a=!e.closeSidebarNode||e.autoClose||!1;this.addSidebar_setCloseSidebarNodes(e),this.addSidebar_setContainerSidebarNode(e,a),void 0!==e.omitCloseNode&&this.addSidebar_setOmitCloseSidebarNodes(e),this.addSidebar_setOpenSidebarNode(e),this.addedSidebar=!0,this.init()}hide(e){setTimeout(function(){this.sidebarList.forEach(t=>{t.name==e&&t.openStatus&&this.closeActionHandler(t,!0)})}.bind(this,e).bind(this,this),1)}init(){this.sidebars=document.querySelectorAll("[data-sidebar-container]"),this.sidebarElements=document.querySelectorAll("[data-sidebar-action]"),0!=this.sidebars.length&&0!=this.sidebars.length&&(this.sidebars.length>0&&(this.addedSidebar=!0),this.body=document.querySelector("body"),this.sidebarList=[],this.sidebars.forEach(e=>{let t={};t.name=e.dataset.sidebar,t.activationClass=e.dataset.sidebarActivateClass,t.containerNode=e,t.openSidebarNode=[],t.closeSidebarNode=[],t.omitClose=[],this.sidebarElements.forEach(e=>{t.name==e.dataset.sidebar&&("open"==e.dataset.sidebarAction&&t.openSidebarNode.push(e),"close"==e.dataset.sidebarAction&&t.closeSidebarNode.push(e)),"omit-close"==e.dataset.sidebarAction&&e.dataset.sidebarOmit.includes(t.name)&&t.omitClose.push(e)});let i="true"==e.dataset.sidebarAutoClose||!1;t.closeSidebarNode||(i=!0),t.autoClose=i,t.openStatus=!1,this.sidebarList.push(t)}),this.sidebars.length>0&&this.addedSidebar&&(this.execute(),this.initialized=!0))}toggle(e){setTimeout(function(){this.sidebarList.forEach(t=>{t.name==e&&(t.openStatus?this.hide(e):this.show(e))})}.bind(this,e).bind(this,this),1)}show(e){setTimeout(function(){let t=!1;if(this.sidebarList.forEach(i=>{i.name!=e||t||this.sidebarElements.forEach(i=>{i.dataset.sidebar!=e||"open"!=i.dataset.sidebarAction||(t=i)})}),!1!==t){const e=new MouseEvent("mouseup");t.dispatchEvent(e)}else this.die("Can't show sidebar",["Sidebar '"+e+"' not found or initialized"])}.bind(this,e).bind(this,this),1)}addSidebar_autoNaming(e){return this.sidebarList.length>0&&this.sidebarList.forEach(t=>{t.name==e&&this.die("Sidebar name exists!",["A sidebar called '"+e+"' is already added."])}),void 0===e&&(e="ToggleSidebar-"+Date.now(),console.warn('A sidebar name was not specified. "'+e+'" will be used instead ')),e}addSidebar_SBOE(e){const t="Configuration error when adding a toggle sidebar:";let i=[];e instanceof Object||null===e||i.push("addSidebar function requires pass an JS object"),void 0===e.activationClass&&i.push("An activation CSS class was not specified"),void 0!==e.autoClose&&"boolean"!=typeof e.autoClose&&i.push("'autoClose' parameter is not boolean (true or false without quotes)"),void 0===e.containerNode&&i.push("An sidebar node (container or wrapper) was not specified"),void 0===e.openSidebarNode&&i.push("An opener (activate) node was not specified"),i.length>0&&this.die(t,i)}addSidebar_setCloseSidebarNodes(e){void 0!==e.closeSidebarNode&&(e.closeSidebarNode=this.getArrayNodes(e.closeSidebarNode,"close sidebar node"),e.closeSidebarNode instanceof Array?e.closeSidebarNode.forEach(t=>{t.forEach(t=>{t.dataset.sidebar=e.name,t.dataset.sidebarAction="close",t.addEventListener("click",(function(e){e.preventDefault()}))})}):this.die("Close sidebar node error:",["Especified close sidebar node is not valid or not found"]))}addSidebar_setContainerSidebarNode(e,t){e.containerNode=this.getArrayNodes(e.containerNode,"sidebar container node"),e.containerNode instanceof Array?e.containerNode.forEach(i=>{i.forEach(i=>{i.dataset.sidebarContainer="true",i.dataset.sidebar=e.name,i.dataset.sidebarActivateClass=e.activationClass,i.dataset.sidebarAutoClose=t})}):this.die("Container sidebar node error:",["The specified sidebar HTML node container is invalid or not found"])}addSidebar_setOmitCloseSidebarNodes(e){e.omitCloseNode=this.getArrayNodes(e.omitCloseNode),e.omitCloseNode instanceof Array?e.omitCloseNode.forEach(t=>{t.forEach(t=>{let i=[];void 0===t.dataset.sidebarOmit?i.push(e.name):(i.push(t.dataset.sidebarOmit.split(",")),i.push(e.name)),t.dataset.sidebarOmit=i,t.dataset.sidebarAction="omit-close",t.addEventListener("click",(function(e){e.preventDefault()}))})}):this.die("Omit Close node(s) error",["'omitCloseNode' attribute can be an array or string but needs to exists in the HTML code"])}addSidebar_setOpenSidebarNode(e){e.openSidebarNode=this.getArrayNodes(e.openSidebarNode,"open sidebar node"),e.openSidebarNode instanceof Array?e.openSidebarNode.forEach(t=>{t.forEach(t=>{t.dataset.sidebar=e.name,t.dataset.sidebarAction="open",t.addEventListener("click",(function(e){e.preventDefault()}))})}):errorMsg.push("Especified open sidebar node is not valid or not found")}die(e,t){let i=0;throw e="\n"+e+"\n",t.forEach(t=>{i++,e+=i+". "+t+"\n"}),new Error(e)}getArrayNodes(e,t){let i="";const a=[],s=[];if("string"==typeof e){const t=e.charAt(0);"."!==t&&"#"!==t?a.push("String needs to start with dot (.) for class or hastag(#) for id to find the node"):s.push(document.querySelectorAll(e))}if(null!==e&&1===e.nodeType){const t="togglesidebarwrapnodelist"+Date.now();e.setAttribute(t,""),s.push(document.querySelectorAll("["+t+"]")),e.removeAttribute(t)}return e instanceof NodeList&&s.push(e),e instanceof Array&&e.forEach(e=>{s.push(this.getArrayNodes(e,t)[0])}),null!==e&&"string"==typeof e&&e instanceof Array||0!=s[0].length||(i="The node is not valid or mistyped","string"!=typeof e&&"number"!=typeof e||(i+=": '"+e+"'"),a.push(i)),a.length>0&&(i="string"==typeof e&&void 0===t?"'"+e+"'":"The node '"+t+"' ",i+=" is not valid or not found:",this.die(i,a)),s}closeSidebar(e,t){t?(window.removeEventListener("mouseup",this.bodyActionHandler,!1),this.body.classList.remove(e.activationClass),e.openStatus=!1,e.openSidebarNode.forEach(e=>{e.addEventListener("mouseup",this.openActionHandler,!1)})):window.addEventListener("mouseup",this.bodyActionHandler,!1)}execute(){this.addedSidebar||this.initialized?(window.removeEventListener("mouseup",this.bodyActionHandler,!1),this.sidebarList.forEach(e=>{void 0===e.containerNode.dataset.initialized&&(e.openSidebarNode.forEach(e=>{e.removeEventListener("mouseup",this.openActionHandler,!1)}),e.openSidebarNode.forEach(e=>{e.addEventListener("mouseup",this.openActionHandler,!1)}),e.containerNode.dataset.initialized=!0)})):console.warn('\nNo sidebar specified with "data-sidebar" attributes in HTML or an JS object.\n')}openSidebar(e){if(e.stopPropagation(),0==e.button){const t=e.target;this.sidebarList.forEach(e=>{t.dataset.sidebar==e.name?(e.openSidebarNode.forEach(e=>{e.removeEventListener("mouseup",this.openActionHandler,!1)}),this.body.classList.add(e.activationClass),e.openStatus=!0,setTimeout(t=>{t.closeActionHandler(e,!1)},50,this)):!0===e.openStatus&&this.closeActionHandler(e,!0)})}}sidebarBodyListener(e){if(e.stopPropagation(),0==e.button){const t=e.target;let i;this.sidebarList.forEach(e=>{e.openStatus&&(i=e)});const a=t.closest("[data-sidebar="+i.name+"]"),s=t.closest("a");let o=!1;null!==t.closest("[data-sidebar-omit*="+i.name+"]")&&(o=!0);let d=!1;i.closeSidebarNode.forEach(e=>{e.dataset.sidebar==t.dataset.sidebar&&e.dataset.sidebarAction==t.dataset.sidebarAction&&(d=!0)});let n=!1;t!=i.openSidebarNode&&!i.openSidebarNode.includes(t)||o||(n=!0),(t==i.openSidebarNode||i.openSidebarNode.includes(t)||d||i.autoClose&&null===a||null!==s)&&!o&&(window.removeEventListener("mouseup",this.bodyActionHandler,!1),this.closeActionHandler(i,!0))}}}