class ToggleSidebar{name="";evtOpts=!1;addedSidebar=!1;initialized=!1;constructor(e){this.openActionHandler=this.openSidebar.bind(this),this.closeActionHandler=this.closeSidebar.bind(this),this.bodyActionHandler=this.sidebarBodyListener.bind(this),void 0!==e?this.addSidebar(e):this.init()}addSidebar(e){const t="Configuration error when adding a toggle sidebar:";let o=[];e instanceof Object||null===e||o.push("addSidebar function requires an JS object"),void 0===e.activationClass&&o.push("An activation CSS class was not specified"),void 0!==e.autoClose&&"boolean"!=typeof e.autoClose&&o.push("'autoClose' parameter is not boolean (true or false without quotes)"),void 0===e.containerNode&&o.push("An sidebar node (container or wrapper) was not specified"),void 0===e.openSidebarNode&&o.push("An opener (activate) node was not specified"),o.length>0&&this.die(t,o),void 0===e.name&&(e.name="ToggleSidebar-"+Date.now(),console.warn('A sidebar name was not specified. "'+e.name+'" will be used instead '));const i=!e.closeSidebarNode||e.autoClose||!1;void 0!==e.closeSidebarNode&&(e.closeSidebarNode=this.getArrayNodes(e.closeSidebarNode,"close sidebar node"),e.closeSidebarNode instanceof Array?e.closeSidebarNode.forEach(t=>{t.forEach(t=>{t.dataset.sidebar=e.name,t.dataset.sidebarAction="close"})}):o.push("Especified close sidebar node is not valid or not found")),e.containerNode=this.getArrayNodes(e.containerNode,"sidebar container node"),e.containerNode instanceof Array?e.containerNode.forEach(t=>{t.forEach(t=>{t.dataset.sidebarContainer="true",t.dataset.sidebar=e.name,t.dataset.sidebarActivateClass=e.activationClass,t.dataset.sidebarAutoClose=i})}):o.push("The specified sidebar HTML node container is invalid or not found"),e.omitCloseNode=this.getArrayNodes(e.omitCloseNode),e.omitCloseNode instanceof Array?e.omitCloseNode.forEach(t=>{t.forEach(t=>{let o=[];void 0===t.dataset.sidebarOmit?o.push(e.name):(o.push(t.dataset.sidebarOmit.split(",")),o.push(e.name)),t.dataset.sidebarOmit=o,t.dataset.sidebarAction="omit-close"})}):o.push("'omitCloseNode' attribute can be an array or string but needs to exists in the HTML code"),e.openSidebarNode=this.getArrayNodes(e.openSidebarNode,"open sidebar node"),e.openSidebarNode instanceof Array?e.openSidebarNode.forEach(t=>{t.forEach(t=>{t.dataset.sidebar=e.name,t.dataset.sidebarAction="open"})}):o.push("Especified open sidebar node is not valid or not found"),o.length>0?this.die(t,o):(this.addedSidebar=!0,this.init())}die(e,t){let o=0;throw e="\n"+e+"\n",t.forEach(t=>{o++,e+=o+". "+t+"\n"}),new Error(e)}init(){this.body=document.querySelector("body"),this.sidebars=document.querySelectorAll("[data-sidebar-container]"),this.sidebarsElements=document.querySelectorAll("[data-sidebar-action]"),this.sidebars.length>0&&(this.addedSidebar=!0),this.sidebarsList=[],this.sidebars.forEach(e=>{let t={};t.name=e.dataset.sidebar,t.activationClass=e.dataset.sidebarActivateClass,t.containerNode=e,t.omitClose=[],this.sidebarsElements.forEach(e=>{t.name==e.dataset.sidebar&&("open"==e.dataset.sidebarAction&&(t.openSidebarNode=e),"close"==e.dataset.sidebarAction&&(t.closeSidebarNode=e),"omit-close"==e.dataset.sidebarAction&&t.omitClose.push(e))});let o="true"==e.dataset.sidebarAutoClose||!1;t.closeSidebarNode||(o=!0),t.autoClose=o,t.openStatus=!1,this.sidebarsList.push(t)}),this.sidebars.length>0&&this.addedSidebar&&(this.execute(),this.initialized=!0)}getArrayNodes(e,t){let o="";const i=[],s=[];if("string"==typeof e){const t=e.charAt(0);"."!==t&&"#"!==t?i.push("String needs to start with dot (.) or hastag(#) to find the node"):s.push(document.querySelectorAll(e))}if(1===(null!==e&&e.nodeType)){const t="togglesidebarwrapnodelist"+Date.now();e.setAttribute(t,""),s.push(document.querySelectorAll("["+t+"]")),e.removeAttribute(t)}return e instanceof NodeList&&s.push(e),e instanceof Array&&e.forEach(e=>{s.push(this.getArrayNodes(e,t)[0])}),null!==e&&"string"==typeof e&&e instanceof Array||0!=s[0].length||(o="The node is not valid or mistyped","string"!=typeof e&&"number"!=typeof e||(o+=": '"+e+"'"),i.push(o)),i.length>0&&(o="string"==typeof e&&void 0===t?"'"+e+"'":"The node '"+t+"' ",o+=" is not valid or not found:",this.die(o,i)),s}closeSidebar(e,t){t?(window.removeEventListener("mousedown",this.bodyActionHandler,!1),this.body.classList.remove(e.activationClass),e.openStatus=!1,e.openSidebarNode.addEventListener("mousedown",this.openActionHandler,!1)):window.addEventListener("mousedown",this.bodyActionHandler,!1)}execute(){this.addedSidebar||this.initialized?(window.removeEventListener("mousedown",this.bodyActionHandler,!1),this.sidebarsList.forEach(e=>{void 0===e.containerNode.dataset.initialized&&(e.openSidebarNode.removeEventListener("mousedown",this.openActionHandler,!1),e.openSidebarNode.addEventListener("mousedown",this.openActionHandler,!1),e.containerNode.dataset.initialized=!0)})):console.warn('\nNo sidebar specified with "data-sidebar" attributes in HTML or an JS object.\n')}openSidebar(e){e.stopPropagation();const t=e.target;this.sidebarsList.forEach(e=>{t.dataset.sidebar==e.name?(e.openSidebarNode.removeEventListener("mousedown",this.openActionHandler,!1),this.body.classList.add(e.activationClass),e.openStatus=!0,setTimeout(t=>{t.closeActionHandler(e,!1)},50,this)):!0===e.openStatus&&this.closeActionHandler(e,!0)})}sidebarBodyListener(e){e.stopPropagation();const t=e.target;let o;this.sidebarsList.forEach(e=>{e.openStatus&&(o=e)});const i=t.closest("[data-sidebar="+o.name+"]"),s=t.closest("a");let a=!1;void 0!==t.dataset.sidebarAction&&"omit-close"==t.dataset.sidebarAction&&t.dataset.sidebarOmit.split(",").forEach(e=>{o.name==e&&(a=!0)}),(t==o.openSidebarNode||t==o.closeSidebarNode||o.autoClose&&null===i||null!==s)&&!a&&(window.removeEventListener("mousedown",this.bodyActionHandler,!1),this.closeActionHandler(o,!0))}}